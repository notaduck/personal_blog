webpackJsonp([0xcdc951e89a33],{356:function(e,n){e.exports={data:{markdownRemark:{html:'<p>Graylog2 is a centralized log management system. It is based on Elasticsearch\nand MongoDB, and are able to analyze and aggregate log messages from multiple sources.\nI don\'t think it would be wrong to say that Graylog2 is one of the big players when\nit comes to centralized log management systems.\nIt won\'t take you a long time to understand how to use Graylog2 and when you do, then\nyou wouldn\'t be with out it!</p>\n<p>I am using Graylog2 to pull log files from all my servers and a PfSense firewall,\nand my life have become much more simple afterwards! it is so easy to create a stream of the exact log files you want to collect.\nJust to give you a example of what a stream is then i have createated a stream\nthere is showing me Accepted/Failed SSH and OpenVPN login attempts. And one for every\ntime a root user is being used.   </p>\n<blockquote>\n<p>Table of Content :</p>\n</blockquote>\n<ul>\n<li>Step 1. Pre-requisites</li>\n<li>Step 2. Install &#x26; configure Elasticsearch</li>\n<li>Step 3. Install MongoDB</li>\n<li>Step 4. Install &#x26; Configure Graylog2</li>\n<li>Step 5. Install Graylog- web interface</li>\n</ul>\n<h4>Step 1. Pre-requisites</h4>\n<p>You have to be <strong>root</strong>!\nthe first thing we are gonna do is to disable Centos firewall and SeLinux as a start. (we will enable the firewall  later.)</p>\n<pre><code>systemctl disable firewalld\nsystemctl status firewalld\nsystemctl status firewalld\n</code></pre>\n<p>to see if SeLinux is enabled on your system type <code>sestatus</code> if it is disabled then skip this part,</p>\n<pre><code>[root@graylog2 ~]# sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          disabled\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      28\n</code></pre>\n<p>If it is enabled then open the .config file</p>\n<pre><code>vim /etc/sysconfig/selinux\n</code></pre>\n<p>find the line below and set it to SELINUX=disabled</p>\n<pre><code>SELINUX=enforced\n</code></pre>\n<p>and restart your system. once you are in again then try to see the status again. It should have changed disabled now</p>\n<pre><code>[root@graylog2 ~]# sestatus\nSELinux status:                 disabled\n</code></pre>\n<p>Enable <a href="https://fedoraproject.org/wiki/EPEL">EPEL Repository</a></p>\n<pre><code># wget http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm\n# rpm -ivh epel-release-7-5.noarch.rpm\n</code></pre>\n<p>and after you have enabled EPEL then install Java.</p>\n<pre><code># yum install Java\n</code></pre>\n<p>Verify that Java have been installed</p>\n<pre><code># java -version\nopenjdk version "1.8.0_65"\nOpenJDK Runtime Environment (build 1.8.0_65-b17)\nOpenJDK 64-Bit Server VM (build 25.65-b01, mixed mode)\n</code></pre>\n<p>We are also going to need pwgen later</p>\n<pre><code>yum -y install pwgen\n</code></pre>\n<h4>Step 2. Install &#x26; configure Elasticsearch</h4>\n<p>First import the GPG-Key</p>\n<pre><code>rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch\n</code></pre>\n<p>Add Elasticsearch to your repositoriy</p>\n<pre><code>vim /etc/yum.repos.d/elasticsearch.repo\n</code></pre>\n<p>And insert the following lines</p>\n<pre><code>[elasticsearch-1.7]\nname=Elasticsearch repository for 1.7.x packages\nbaseurl=http://packages.elastic.co/elasticsearch/1.7/centos\ngpgcheck=1\ngpgkey=http://packages.elastic.co/GPG-KEY-elasticsearch\nenabled=1\n</code></pre>\n<p>You should be ready to install Elasticsearch now</p>\n<pre><code># yum -y install elasticsearch\n</code></pre>\n<p>Configure Elasticseach to start during system startup.</p>\n<pre><code># systemctl daemon-reload\n# systemctl enable elasticsearch.service\n</code></pre>\n<p>There is only one important configuration we have to set in Elasticsearch\nto make it work with Graylog2</p>\n<pre><code># vim /etc/elasticsearch/elasticsearch.yml\n</code></pre>\n<p>Find line 32 in the file and set the cluster name to graylog2</p>\n<pre><code> 27 ################################### Cluster ###################################\n 28\n 29 # Cluster name identifies your cluster for auto-discovery. If you\'re running\n 30 # multiple clusters on the same network, make sure you\'re using unique names.\n 31 #\n 32 cluster.name: graylog2\n 33\n 34\n</code></pre>\n<p>that should be it. now restart the service to make it read the new settings</p>\n<pre><code>#systemctl restart elasticsearch.service\n</code></pre>\n<h4>Step 3. Install MongoDB</h4>\n<p>Almos same procedure as in step 2. but this time will we add the repository\nfor MongoDB</p>\n<pre><code># vim /etc/yum.repos.d/mongodb-org-3.0.repo\n</code></pre>\n<p>Add the lines below quit and save.</p>\n<pre><code>[mongodb-org-3.0]\nname=MongoDB Repository\nbaseurl=http://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.0/x86_64/\ngpgcheck=0\nenabled=1\n</code></pre>\n<p>Install MongoDB</p>\n<pre><code># yum -y install mongodb-org\n</code></pre>\n<h4>Step 4. Install &#x26; Configure Graylog2</h4>\n<p>First install Graylog2\'s repository</p>\n<pre><code># rpm -Uvh https://packages.graylog2.org/repo/packages/graylog-1.2-repository-el7_latest.\n</code></pre>\n<p>Then install Graylog2</p>\n<pre><code># yum -y install graylog-server\n</code></pre>\n<p>Before we are going to configure Graylog2\'s .conf file i want you to do two things.\nremember to copy and save the output.!</p>\n<p>Number 1. Create a password with pwgen for password_secret</p>\n<pre><code># pwgen -N 1 -s 96\nHz63qI3vRiJezJ6U44PmgtNV5eh0ixiBlRImqPwJAOeUDaWb5wopeSXavxFdzHlAP6BZtJBol8fdHqDjrOCoUq2fczBGhud6\n</code></pre>\n<p>Number 2. Get  the sha265 sum of your accounts password</p>\n<pre><code># echo -n yourpassword | sha256sum\ne3c652f0ba0b4801205814f8b6bc49672c4c74e25b497770bb89b22cdeb4e951  -\n</code></pre>\n<p>And now is the time to configure Graylog2.<br>\nopen the .conf file</p>\n<pre><code>vim /etc/graylog/server/server.conf\n</code></pre>\n<p>Find the lines below in the configuration file and edit them. (This is a configuration example for only one host)</p>\n<pre><code>password_secret = Insert number 1. output\n\nroot_password_sha2 = insert number 2. output\n\nroot_timezone = UTC\n\nelasticsearch_http_enabled = false\n\nelasticsearch_discovery_zen_ping_unicast_hosts = graylog2-server-ip:9300\n\nelasticsearch_shards = 1\n\nelasticsearch_replicas = 0\n\nmongodb_useauth = false\n</code></pre>\n<p>and restart the Graylog2 server to make it load the new configuration.</p>\n<pre><code>systemctl restart graylog-server\n</code></pre>\n<h4>Step 5. Install Graylog- web interface</h4>\n<p>We are going to install a web interface for Graylog2 as well.</p>\n<pre><code>yum -y install graylog-web\n</code></pre>\n<p>And first create a new password with pwgen(remember to copy the output)</p>\n<pre><code>pwgen -N 1 -s 96\n</code></pre>\n<pre><code>vim /etc/graylog/web/web.conf\n</code></pre>\n<p>edit the following lines in the configuration file. if you want to add more Graylog2 nodes in the future then just separate the IP with a comma.</p>\n<pre><code>graylog2-server.uris="http://127.0.0.1:12900/"\napplication.secret=""\n</code></pre>\n<p>we are going to let CentOS start graylog-web on boot.</p>\n<pre><code>systemctl enable graylog-web\nsystemctl restart graylog-web\n</code></pre>\n<p>and open your web-browser and type in <code>raylog2_ip:9000</code>. You should see a screen like this. your\nusername is <strong>admin</strong> and the password is the one you created earlier in the guide.</p>\n<p>See also how you can :</p>\n<blockquote>\n<ul>\n<li>Create syslog input and configure rsyslog.</li>\n<li>Add extractors</li>\n<li>How to let Gratlog2 send mails with Gmail SMTP</li>\n<li>Connect Pfsense with the snort package to Graylog2</li>\n</ul>\n</blockquote>',frontmatter:{path:"/markdown-post",title:"Setup Graylog2 - Centos 7"}}},pathContext:{}}}});
//# sourceMappingURL=path---markdown-post-fa56bf20514985089ff7.js.map